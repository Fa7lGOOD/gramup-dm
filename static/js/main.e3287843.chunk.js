(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){e.exports=n(36)},29:function(e,t,n){},31:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(19),i=n.n(r),o=(n(29),n(2)),c=n.n(o),u=n(8),d=n(3),l=n(6),h=n(5),m=n(1),p=n(4),g=(n(31),n(22)),f=n(10),b=n(11),v=n(20),w=n(14),j=window.chrome,_=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(d.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,a))).status=e,n.message="InstagramError ".concat(e,": ").concat(a),n}return Object(p.a)(t,e),t}(Object(b.a)(Error)),O=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(Object(b.a)(Error)),k=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(Object(b.a)(Error)),x=new function e(){var t=this;Object(d.a)(this,e),this._currend_id="",this._instaweb_dev_id="jfeioppjmfoialcnpnecpgdajnionodc",this._instaweb_id="njonkbhnmmjgancfbncekpgkmidhbbpo",this.isStopped=!1,this.isConnected=!1,this._check_working_id=function(){return new Promise(function(e,n){setTimeout(function(){return n(new k("Cant find any working extension"))},500),j.runtime.sendMessage(t._instaweb_id,{method:"ping"},null,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.status,s=n.pong;return"ok"===a&&s&&e(t._instaweb_id)}),j.runtime.sendMessage(t._instaweb_dev_id,{method:"ping"},null,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.status,s=n.pong;return"ok"===a&&s&&e(t._instaweb_dev_id)})})},this.init=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t._check_working_id();case 3:t._currend_id=e.sent,t.isConnected=!0,e.next=13;break;case 7:if(e.prev=7,e.t0=e.catch(0),!(e.t0 instanceof O)){e.next=12;break}return t.isConnected=!1,e.abrupt("return");case 12:throw e.t0;case 13:case"end":return e.stop()}},e,null,[[0,7]])})),this.start=function(){return t.isStopped=!1},this.kill=function(){return t.isStopped=!0},this.request=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(a,s){var r=!t.isStopped;return n&&!r&&t.start(),t.isStopped?s(new Error("Request was killed")):t.isConnected?(setTimeout(function(){return s(new O("Request timeout"))},1e4),console.log("send_message",t._currend_id,e),j.runtime.sendMessage(t._currend_id,e,null,function(t){if(!t)return s(new k);var n=t.status,r=t.error;console.log("request",e.method,"->",n,t),"ok"!==n?s(new _(n,r)):a(t)}),void(n&&!r&&t.kill())):s(new k)})},this.request_generator=function(){var e=Object(w.a)(c.a.mark(function e(t){var n,a,s,r,i,o,u,d=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.method,a=t.params,s=d.length>1&&void 0!==d[1]?d[1]:1/0,r=[],i=this.page_generator({method:n,params:a});case 4:return o=i.next(),u=o.users,console.log("users",u),r=[].concat(Object(f.a)(r),Object(f.a)(u)),e.next=9,u;case 9:if(!(e.sent||r.length>s)){e.next=12;break}return e.abrupt("return",r);case 12:e.next=4;break;case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.page_generator=function(){var e=Object(w.a)(c.a.mark(function e(t){var n,a,s,r,i,o,u,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.method,a=t.params,s=a;case 2:return r={method:n,params:s},e.next=5,Object(v.a)(this.request(r));case 5:return i=e.sent,o=i.big_list,u=i.next_max_id,d=Object(g.a)(i,["big_list","next_max_id"]),console.log("big_list",o,"next_max_id",u),e.next=12,d;case 12:if(!e.sent&&u){e.next=15;break}return e.abrupt("return");case 15:s=[].concat(Object(f.a)(a),[u]);case 16:e.next=2;break;case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},y=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"dialog-list"},this.props.threads.map(function(t){return s.a.createElement("div",{key:t.thread_id,className:"dialog-list-item"},s.a.createElement("div",{onClick:function(){return e.props.selectThread(t)}},t.thread_title))}))}}]),t}(a.Component),T=n(13),E=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={isTyping:!1,messages:[]},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.messages.map(function(e){return new T.Message({id:e.user_id===t.props.me?0:e.user_id,message:e.text||e.item_type})});console.log("me",this.props.me),this.setState({messages:n})}},{key:"render",value:function(){return this.props.isLoading?s.a.createElement("div",{className:"dialog"},"Loading..."):s.a.createElement("div",null,s.a.createElement(T.ChatFeed,{messages:this.state.messages,isTyping:this.state.isTyping,showSenderName:!0,bubblesCentered:!1,bubbleStyles:{text:{fontSize:20},chatbubble:{borderRadius:30,padding:20}}}))}}]),t}(a.Component),S=n(21),C=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={isTyping:!1,text:""},n.sendMessageRef=s.a.createRef(),n.handleChange=function(e){var t=e.target,a=t.name,s=t.value;n.setState(Object(S.a)({},a,s))},n.submitMessage=function(e){e.preventDefault();var t=n.state,a=t.selectedThread,s=t.text;s&&n.props.sendMessage(a,s)},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({selectedThread:e.selectedThread})}},{key:"render",value:function(){return s.a.createElement("div",{className:"dialog-send-message"},s.a.createElement("form",{onSubmit:this.submitMessage},s.a.createElement("input",{type:"text",name:"text",onChange:this.handleChange,value:this.state.text}),s.a.createElement("button",{onClick:this.submitMessage},"Send")))}}]),t}(a.Component),M=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={threads:[],messages:[],selectedThread:null,isLoading:!1,autoScroll:!0},n.messagesEnd=s.a.createRef(),n.scrollToBottom=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n.state.autoScroll||e){var t=n.messagesEnd.current;t.parentNode.scrollTop=t.offsetTop}},n.loadThread=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),e.next=3,x.request({method:"get_thread",params:[t.thread_id]},!0);case 3:a=e.sent,s=a.thread.items,console.log("messages",s),n.setState({isLoading:!1,selectedThread:t,messages:s.reverse()},function(){return n.scrollToBottom()});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.sendMessage=function(){var e=Object(u.a)(c.a.mark(function e(t,a){var s,r,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),console.log("send dm",a),s=["text",{thread:t.thread_id,text:a}],console.log("send dm params",s),e.next=6,x.request({method:"send_direct_item",params:s},!0);case 6:r=e.sent,i=r.status,console.log("status",i),n.loadThread(t);case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,s,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.instagram=x,e.next=3,x.init();case 3:return e.next=5,x.request({method:"get_inbox",params:[]},!0);case 5:t=e.sent,n=t.viewer,a=t.inbox.threads,console.log("threads",a),s=n.pk,this.setState({me:s,threads:a}),r=a[0],this.loadThread(r);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement(y,{threads:this.state.threads,selectedThread:this.state.selectedThread,selectThread:this.loadThread}),s.a.createElement("div",{className:"dialog"},s.a.createElement(E,{me:this.state.me,isLoading:this.state.isLoading,selectedThread:this.state.selectedThread,messages:this.state.messages}),s.a.createElement(C,{selectedThread:this.state.selectedThread,sendMessage:this.sendMessage}),s.a.createElement("div",{style:{float:"left",clear:"both"},ref:this.messagesEnd})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[23,1,2]]]);
//# sourceMappingURL=main.e3287843.chunk.js.map